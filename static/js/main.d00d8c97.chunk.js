(this["webpackJsonpcwn-onto-3d"]=this["webpackJsonpcwn-onto-3d"]||[]).push([[0],{20:function(e,n,t){e.exports=t(51)},25:function(e,n,t){},26:function(e,n,t){},27:function(e,n,t){},28:function(e,n,t){},50:function(e,n,t){},51:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),c=t(14),r=t.n(c),s=(t(25),t(26),t(1)),l=(t(27),"http://140.112.147.132:5555/");function i(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(n?fetch("data/tag.json"):fetch(l+"tag",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sentences:[e]})})).then((function(e){return e.json()})).then((function(e){return e.data[0]}))}function u(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(n?fetch("data/wsd.json"):fetch(l+"wsd",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tagged:[e]})})).then((function(e){return e.json()})).then((function(e){return e.data[0]}))}function d(e){var n,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)n=fetch("data/lemmas.json");else{var a=e.map((function(e){return e[0]})).join(","),o=new URL(l+"lemma");o.search=new URLSearchParams({lemmas:a}).toString(),n=fetch(o.toString())}return n.then((function(e){return e.json()})).then((function(e){return e.data}))}function f(e){var n,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)n=fetch("data/sense_clouds.json");else{var a=e.map((function(e){return e[2]})).join(","),o=new URL(l+"sense_cloud");o.search=new URLSearchParams({sids:a}).toString(),n=fetch(o.toString())}return n.then((function(e){return e.json()})).then((function(e){return e.data}))}function m(e){var n,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)n=fetch("data/sense_clouds.json");else{var a=new URL(l+"sense_data/"+e);n=fetch(a.toString())}return n.then((function(e){return e.json()})).then((function(e){return e.data}))}function p(){return{sentence:"",tokens:[],senseClouds:{},lemmaSenses:{},selSenseData:{}}}function h(e,n){var t=Object.assign({},e);switch(n.type){case"NEW_SENTENCE":t.sentence=n.payload;break;case"NEW_TAGGED":t.tokens=n.payload;break;case"NEW_LEMMA_SENSES":t.lemmaSenses=n.payload;break;case"NEW_SENSE_CLOUDS":t.senseClouds=n.payload;break;case"SELECT_SENSE":t.selSenseData=n.payload;break;case"RESET_STATE":t={sentence:"",tokens:[],senseClouds:{},lemmaSenses:{},selSenseData:{}}}return t}t(28);function E(e){console.log("WsdView"),console.log(e);var n=e.tokens.map((function(e,n){return o.a.createElement("div",{key:"token-".concat(e[0],"-").concat(n),className:"token-wrapper"},o.a.createElement("div",{className:"pos"},e[1].endsWith("CATEGORY")?"":e[1]),o.a.createElement("div",{className:"word"},e[0]),o.a.createElement("div",{className:"badge badge-info sense-def"},e[3]))}));return o.a.createElement("div",{className:"d-flex flex-wrap"},n)}var v=t(18);t(50);function y(e){var n;return Object(a.useEffect)((function(){console.log("sense 3d view");var t=function(e,n,t){var a={},o={},c={};e.map((function(e,n){var t=e[0],o="".concat(t,"-").concat(n);t in c?c[t].push(o):c[t]=[o],a[o]={id:o,type:"Lemma",label:t,fx:100*n,fy:0,fz:0}})),Object.entries(n).map((function(e,n){var t=Object(s.a)(e,2),r=t[0];t[1].map((function(e){a[e.id]={id:e.id,type:"CwnSense",label:"(".concat(e.pos,") ").concat(e.definition),fx:c[r].reduce((function(e,n){return e+=void 0!==a[n].fx?a[n].fx:0}),0)/c[r].length},c[r].map((function(n){var t="".concat(n,"-").concat(e.id);o[t]={source:n,target:e.id,label:"hasSense"}}))}))})),t=t||{},Object.entries(t).map((function(e,n){var t=Object(s.a)(e,2),c=t[0],r=t[1];r.relations.map((function(e){var n=Object(s.a)(e,5),t=(n[0],n[1]),r=n[2],l=n[3],i=n[4];t in a||(a[t]={id:t,type:"CwnSense",label:"[".concat(r,"] (").concat(l,") ").concat(i)});var u="".concat(c,"-").concat(t);o[u]={source:c,target:t,label:"CwnRelation"}}));var l=Object(s.a)(r.pwn,2),i=(l[0],l[1]);if(void 0!==i&&""!==i){i in a||(a[i]={id:i,type:"PwnSynset",label:i,fy:-200});var u="".concat(c,"-").concat(i);o[u]={source:c,target:i,label:"PwnMapping"}}var d=r.pwn_onto,f=function(e,n,t){void 0!==e&&e.reduce((function(e,n){n in a||(a[n]={id:n,type:"HyperHypo",label:n,fy:-400});var c="".concat(e,"-").concat(n);return o[c]={source:e,target:n,label:t},n}),n)},m=function(e,n,t){void 0!==e&&e.map((function(e){e in a||(a[e]={id:e,type:"HoloMero",label:e,fy:-400});var c="".concat(n,"-").concat(e);o[c]={source:n,target:e,label:t}}))};f(d.hypernyms,i,"hypernymy"),f(d.hyponyms,i,"hyponymy"),m(d.holonyms,i,"holonymy"),m(d.meronyms,i,"meronymy")}));var r={nodes:Object.values(a),links:Object.values(o)};return console.log(r),r}(e.tokens,e.lemmaSenses,e.senseClouds),a=document.getElementById("graph-3d");if(null!==a){n=Object(v.a)()(a);var o=a.parentElement.clientWidth;n.graphData(t).width(o).height(600).nodeLabel("label").nodeAutoColorBy("type").nodeVal((function(e){return"Lemma"==e.type?20:3})).linkWidth(3).zoomToFit(500,20)}}),[e.lemmaSenses,e.senseClouds]),o.a.createElement("div",{id:"graph-3d"})}function S(){var e=function(){var e=Object(a.useReducer)(h,{},p),n=Object(s.a)(e,2),t=n[0],o=n[1];return{ontoState:t,controller:{updateSentence:function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==t.sentence&&(o({type:"RESET_STATE"}),o({type:"NEW_SENTENCE",payload:e}),i(e,a).then((function(e){return console.log("tagged"),console.log(e),o({type:"NEW_TAGGED",payload:e}),d(e,a).then((function(e){console.log("lemma senses"),console.log(e),o({type:"NEW_LEMMA_SENSES",payload:e})})),u(e,a)})).then((function(e){return console.log("wsd"),console.log(e),o({type:"NEW_TAGGED",payload:e}),f(e,a)})).then((function(e){console.log("sense clouds"),console.log(e),o({type:"NEW_SENSE_CLOUDS",payload:e}),n()})))},selectSense:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m(e,n).then((function(e){console.log("sense data"),console.log(e),o({type:"SELECT_SENSE",payload:e})}))}}}}(),n=e.ontoState,t=e.controller,c=Object(a.useRef)(null),r=Object(a.useState)(!1),l=Object(s.a)(r,2),v=l[0],S=l[1];Object(a.useEffect)((function(){t.updateSentence("<default>",(function(){return S(!1)}),!0)}),[]);var g=v?o.a.createElement("div",{className:"loader"},"Loading"):null;return o.a.createElement("div",{className:"container"},o.a.createElement("input",{ref:c,id:"inputText",type:"text",onKeyDown:function(e){if("Enter"===e.key&&(console.log("enter"),c.current)){S(!0);var n=c.current.value;t.updateSentence(n,(function(){return S(!1)}))}},placeholder:"\u8f38\u5165\u53e5\u5b50"}),o.a.createElement("div",{className:"cwn-onto-3d"},g,o.a.createElement(E,{tokens:n.tokens}),o.a.createElement(y,{tokens:n.tokens,lemmaSenses:n.lemmaSenses,senseClouds:n.senseClouds})))}var g=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(S,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.d00d8c97.chunk.js.map